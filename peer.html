

<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>PeerJS Text Chat</title>
  <script src="https://unpkg.com/peerjs@1.4.7/dist/peerjs.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    #log { border: 1px solid #ccc; padding: 10px; height: 200px; overflow-y: scroll; margin-bottom: 10px; }
    #peer-id, #connect-to { width: 200px; }
  </style>
</head>
<body>
  <h2>PeerJS Text Chat</h2>
  <p>Your Peer ID: <span id="my-id">...</span></p>

  <input type="text" id="connect-to" placeholder="Peer ID to connect">
  <button id="connect-btn">Connect</button>

  <div id="log"></div>

  <input type="text" id="message" placeholder="Type a message">
  <button id="send-btn">Send</button>

  <script>
    const peer = new Peer();

    const logEl = document.getElementById('log');
    const connectToInput = document.getElementById('connect-to');
    const messageInput = document.getElementById('message');
    const sendBtn = document.getElementById('send-btn');
    const connectBtn = document.getElementById('connect-btn');
    const myIdEl = document.getElementById('my-id');

    let conn;

    peer.on('open', id => {
      myIdEl.textContent = id;
    });

    peer.on('connection', connection => {
      conn = connection;
      setupConnection();
    });

    connectBtn.onclick = () => {
      const peerId = connectToInput.value;
      conn = peer.connect(peerId);
      setupConnection();
    };

    sendBtn.onclick = () => {
      const msg = messageInput.value;
      if (conn && conn.open) {
        conn.send(msg);
        appendMessage('You: ' + msg);
        messageInput.value = '';
      }
    };

    function setupConnection() {
      conn.on('data', data => {
        appendMessage('Peer: ' + data);
      });
      conn.on('open', () => appendMessage('[Connected]'));
      conn.on('close', () => appendMessage('[Connection closed]'));
    }

    function appendMessage(text) {
      const p = document.createElement('p');
      p.textContent = text;
      logEl.appendChild(p);
      logEl.scrollTop = logEl.scrollHeight;
    }
  </script>
</body>
</html>